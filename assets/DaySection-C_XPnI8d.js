import{j as e}from"./jsx-runtime-u17CrQMm.js";import{r as a}from"./iframe-KW6RtBM2.js";import{D as F}from"./tasks-BV5_RF93.js";import{f as L,T as V}from"./TaskItem-Di_rPK8a.js";import{I as r}from"./Icon-CFZCLKt0.js";import{c as u}from"./index-goBt61iM.js";import{u as M}from"./useVoiceInput-BWfKLRX-.js";import{u as P,a as H}from"./SettingsContext-CelCWxaL.js";import{C as K,a as _,b as q}from"./collapsible-h46-68d_.js";import{m as y}from"./proxy-B9VYbwnC.js";import{A as B}from"./index-6uNkXKNh.js";const G=({group:s})=>{const{onAddTask:w,onAICommand:T}=P(),{settings:o,isAiMode:d,onVoiceError:I}=H(),[f,S]=a.useState(!0),[l,c]=a.useState(!1),[m,p]=a.useState(""),[h,v]=a.useState(o.defaultCategory),[N,k]=a.useState(!1),g=a.useRef(null);a.useEffect(()=>{l&&v(o.defaultCategory)},[l,o.defaultCategory]);const{isListening:b,start:A}=M(o.enableVoiceInput,t=>p(n=>n?`${n} ${t}`:t),I),j=F.fromISO(s.date),D=j.toFormat("ccc"),z=j.weekday>5,$=z?"text-rose-500 bg-rose-50 border-rose-100":"text-slate-600 bg-slate-50 border-slate-200",x=L(s.date),C=x==="Today"||x==="Tomorrow"||x==="Yesterday",E=j.toFormat(o.dateFormat);a.useEffect(()=>{l&&g.current&&g.current.focus()},[l]);const i=a.useMemo(()=>s.tasks.reduce((t,n)=>(n.status==="done"?t.done++:n.status==="overdue"||n.status==="due"?t.urgent++:["todo","scheduled","unplanned"].includes(n.status)&&t.open++,t),{done:0,urgent:0,open:0}),[s.tasks]),O=async()=>{if(!m.trim()){c(!1);return}k(!0);try{if(o.aiConfig.enabled&&d){const t=`Add task to ${s.date}: ${m} (Category: ${h})`;await T(t)}else w({title:m,dueAt:s.date,category:h});p("")}catch(t){console.error(t)}finally{k(!1)}},R=t=>{t.key==="Enter"&&O(),t.key==="Escape"&&(c(!1),p(""))},W={sm:"mt-0.5",base:"mt-0.5",lg:"mt-1",xl:"mt-1.5"}[o.fontSize]||"mt-0.5";return e.jsx("div",{className:"mb-2 relative",children:e.jsxs(K,{open:f,onOpenChange:S,children:[e.jsx(_,{asChild:!0,children:e.jsxs("button",{className:"w-full flex items-center justify-between mb-1 sticky top-0 bg-paper/95 backdrop-blur-sm z-20 py-1.5 border-b border-dashed border-slate-200 group hover:border-slate-300 transition-colors text-left outline-none pl-2",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(y.div,{animate:{rotate:f?90:0},transition:{duration:.2},className:"text-slate-400",children:e.jsx(r,{name:"ChevronRight",size:14})}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[C&&e.jsx("span",{className:"text-xs font-bold text-blue-600 font-mono uppercase tracking-tight",children:x}),e.jsx("h3",{className:`text-sm font-bold text-slate-800 font-mono tracking-tight group-hover:text-blue-600 transition-colors ${C?"opacity-60 font-normal":""}`,children:E})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0 opacity-80 group-hover:opacity-100 transition-opacity",children:[i.urgent>0&&e.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-rose-100/50 text-rose-600 border border-rose-200/50 shadow-sm shadow-rose-100",children:[e.jsx(r,{name:"AlertCircle",size:10,strokeWidth:2.5}),e.jsx("span",{className:"text-[10px] font-bold leading-none",children:i.urgent})]}),i.open>0&&e.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-slate-100 text-slate-500 border border-slate-200 shadow-sm shadow-slate-100",children:[e.jsx(r,{name:"Circle",size:10,strokeWidth:2.5}),e.jsx("span",{className:"text-[10px] font-bold leading-none",children:i.open})]}),i.done>0&&e.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-emerald-100/50 text-emerald-600 border border-emerald-200/50 shadow-sm shadow-emerald-100",children:[e.jsx(r,{name:"CheckCircle2",size:10,strokeWidth:2.5}),e.jsx("span",{className:"text-[10px] font-bold leading-none",children:i.done})]})]})]}),e.jsxs("div",{className:`flex flex-col items-center justify-center w-8 h-8 rounded-lg border ${$} shadow-sm shrink-0 ml-2`,children:[e.jsx("span",{className:"text-[10px] font-bold uppercase leading-none",children:D}),e.jsx("span",{className:"text-[10px] opacity-60 leading-none mt-0.5",children:s.tasks.length})]})]})}),e.jsx(B,{initial:!1,children:f&&e.jsx(q,{forceMount:!0,asChild:!0,children:e.jsx(y.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:e.jsxs("div",{className:"space-y-0.5 relative pb-2",children:[s.tasks.map(t=>e.jsx(V,{task:t},t.id)),e.jsxs("div",{className:"group relative flex items-stretch gap-2 py-1.5 px-1 transition-all rounded-lg",children:[e.jsxs("div",{className:u("relative flex flex-col items-center shrink-0 w-6",W),children:[s.tasks.length>0&&e.jsx("div",{className:"absolute -top-1 h-4 w-px left-1/2 -translate-x-1/2 bg-slate-200"}),e.jsx("button",{onClick:()=>c(!0),className:u("relative z-10 w-6 h-6 flex items-center justify-center rounded-full transition-all outline-none",l?d?"bg-purple-100 text-purple-600":"bg-blue-100 text-blue-600":"bg-white hover:bg-slate-100 text-slate-300 hover:text-blue-500"),children:N?e.jsx("div",{className:"animate-spin",children:e.jsx(r,{name:"Loader2",size:12})}):e.jsx(r,{name:d?"Sparkles":"Plus",size:14})})]}),e.jsx("div",{className:"flex-1 min-w-0 pt-0.5",children:l?e.jsxs(y.div,{initial:{opacity:0,x:-5},animate:{opacity:1,x:0},className:"flex items-center gap-2",children:[e.jsx("input",{ref:g,type:"text",value:m,onChange:t=>p(t.target.value),onKeyDown:R,onBlur:t=>{(!t.relatedTarget||!t.relatedTarget.closest(".add-row-actions"))&&(m||c(!1))},placeholder:b?"Listening...":d?"Describe task for this day...":"Type a new task...",className:u("flex-1 bg-transparent border-b focus:outline-none text-sm py-0.5 transition-colors",d?"border-purple-300 focus:border-purple-500 placeholder:text-purple-300 text-purple-900":"border-blue-300 focus:border-blue-500"),disabled:N||b}),e.jsxs("div",{className:"flex items-center gap-1 add-row-actions",children:[e.jsxs("div",{className:"relative group/cat",children:[e.jsx("input",{list:`cat-list-${s.date}`,className:"w-20 text-[10px] bg-slate-100 hover:bg-slate-200 border-none rounded px-1.5 py-0.5 text-slate-600 focus:bg-white focus:ring-1 focus:ring-blue-300 outline-none transition-all placeholder:text-slate-400 truncate",placeholder:"Category",value:h,onChange:t=>v(t.target.value),onFocus:()=>{},title:"Task Category"}),e.jsxs("datalist",{id:`cat-list-${s.date}`,children:[e.jsx("option",{value:"Work"}),e.jsx("option",{value:"Personal"}),e.jsx("option",{value:"Home"}),e.jsx("option",{value:"Health"}),e.jsx("option",{value:"Finance"}),e.jsx("option",{value:"Urgent"})]})]}),o.enableVoiceInput&&e.jsx("button",{onClick:A,className:u("p-1 rounded hover:bg-slate-100 transition-colors",b&&"text-rose-500 animate-pulse"),tabIndex:-1,children:e.jsx(r,{name:"Mic",size:14})})]})]}):e.jsx("button",{onClick:()=>c(!0),className:"text-left text-sm text-slate-400 hover:text-blue-500 transition-colors h-5.5 flex items-end font-medium",children:"Add task..."})})]})]})})})})]})})};G.__docgenInfo={description:"",methods:[],displayName:"DaySection",props:{group:{required:!0,tsType:{name:"DayGroup"},description:""}}};export{G as D};
