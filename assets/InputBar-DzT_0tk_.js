import{j as e}from"./jsx-runtime-u17CrQMm.js";import{r as B}from"./iframe-KW6RtBM2.js";import{I as l}from"./Icon-CFZCLKt0.js";import{c as x}from"./index-goBt61iM.js";import{D as w}from"./tasks-BV5_RF93.js";import{u as _}from"./useVoiceInput-BWfKLRX-.js";import{M as I,a as q}from"./Motion-DxXHqm4t.js";import{u as H,a as Q}from"./SettingsContext-CelCWxaL.js";import{P as D,a as M,b as P}from"./popover-DUPQEFUd.js";const X=i=>{let a=i;const n={tags:[]},u=/\b(p|priority):(low|medium|high)\b/i,s=a.match(u);s&&(n.priority=s[2].toLowerCase(),a=a.replace(s[0],""));const r=/\bdue:(\S+)\b/i,m=a.match(r);if(m){const c=m[1].toLowerCase();let d="";c==="today"?d=w.now().toISODate()||"":c==="tomorrow"?d=w.now().plus({days:1}).toISODate()||"":w.fromISO(c).isValid&&(d=w.fromISO(c).toISODate()||""),d&&(n.dueAt=d),a=a.replace(m[0],"")}const f=/#(\w+)/g,h=[];let v;for(;(v=f.exec(a))!==null;)h.push(v[1]);h.length>0&&(n.tags=h.map(c=>({id:`new-${c}`,name:c})),a=a.replace(f,""));const k=/\b(cat|category):(\w+)\b/i,g=a.match(k);return g&&(n.category=g[2],a=a.replace(g[0],"")),n.title=a.trim().replace(/\s+/g," "),n},Z=()=>{const{onAddTask:i,onAICommand:a,availableTags:n,availableCategories:u}=H(),{settings:s,filters:r,onFilterChange:m,sort:f,onSortChange:h,isAiMode:v,toggleAiMode:k,onVoiceError:g,onOpenSettings:c}=Q(),[d,S]=B.useState(""),[A,z]=B.useState(!1),{isListening:b,start:T}=_(s.enableVoiceInput,t=>S(o=>o?`${o} ${t}`:t),g),p=s.aiConfig.enabled&&v,L=async()=>{if(!(!d.trim()||A)){z(!0);try{if(p)await a(d);else{const t=X(d);i(t)}S("")}catch(t){console.error("Failed to parse task",t)}finally{z(!1)}}},V=t=>{t.key==="Enter"&&L()},j=(t,o)=>{const F=r[t];if(Array.isArray(F)){const O=F,$=O.includes(o)?O.filter(U=>U!==o):[...O,o];m({...r,[t]:$})}},y=t=>{m({...r,[t]:[]})},N=t=>{const o=r[t];return Array.isArray(o)||typeof o=="string"?o.length>0:!1},R=t=>{switch(t){case"todo":return"Circle";case"doing":return"PlayCircle";case"done":return"CheckCircle2";case"scheduled":return"Clock";case"due":return"AlertCircle";case"overdue":return"AlertTriangle";case"cancelled":return"XCircle";case"unplanned":return"Zap";default:return"Circle"}},E=t=>{switch(t){case"done":return"text-emerald-500";case"doing":return"text-sky-500";case"scheduled":return"text-blue-500";case"due":return"text-amber-500";case"overdue":return"text-rose-500";case"cancelled":return"text-slate-400";case"unplanned":return"text-purple-500";default:return"text-slate-400"}},K=t=>{switch(t){case"high":return"text-rose-500";case"medium":return"text-amber-500";case"low":return"text-blue-400"}};return e.jsx("div",{className:"pt-3 pb-1",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6",children:[e.jsxs("div",{className:"relative group z-10",children:[e.jsx("div",{className:"absolute inset-y-0 left-3 flex items-center pointer-events-none z-10",children:A?e.jsx(I,{animate:{rotate:360},transition:{repeat:1/0,duration:1,ease:"linear"},className:"text-blue-500",children:e.jsx(l,{name:"Loader2",size:16})}):p?e.jsx(I,{initial:{scale:0},animate:{scale:1},className:"text-purple-500",children:e.jsx(l,{name:"Sparkles",size:16})}):e.jsx("div",{className:"text-slate-400",children:e.jsx(l,{name:"PlusCircle",size:16})})}),e.jsx("input",{type:"text",className:x("w-full bg-white pl-10 pr-24 py-2.5 rounded-xl border shadow-sm text-sm focus:outline-none focus:ring-2 transition-all placeholder:text-slate-400 font-medium",p?"border-purple-200 focus:border-purple-400 focus:ring-purple-400/20":"border-slate-200 focus:border-slate-400 focus:ring-slate-400/20"),placeholder:b?"Listening...":p?"Describe tasks using natural language...":"Quick add (e.g., 'Meeting due:tomorrow p:high')",value:d,onChange:t=>S(t.target.value),onKeyDown:V,disabled:A||b}),e.jsxs("div",{className:"absolute inset-y-0 right-3 flex items-center gap-1",children:[s.enableVoiceInput&&e.jsx("button",{onClick:T,className:x("p-1.5 rounded-md transition-all duration-200 relative",b?"text-rose-500 bg-rose-50 animate-pulse":"text-slate-400 hover:text-slate-600 hover:bg-slate-100"),disabled:b,title:"Voice Input",children:e.jsx(l,{name:"Mic",size:16})}),s.aiConfig.enabled&&e.jsx("button",{onClick:k,className:x("p-1.5 rounded-md transition-all duration-200",p?"text-purple-600 bg-purple-50 hover:bg-purple-100 ring-1 ring-purple-200":"text-slate-400 hover:text-slate-600 hover:bg-slate-100"),title:p?"Switch to Manual Mode":"Switch to AI Mode",children:e.jsx(l,{name:p?"Sparkles":"TerminalSquare",size:16})}),c&&s.settingButtonOnInputBar!==!1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px h-4 bg-slate-200 mx-1"}),e.jsx("button",{onClick:c,className:"text-slate-400 hover:text-blue-600 p-1.5 rounded-md hover:bg-blue-50 transition-colors",title:"Settings & Docs",children:e.jsx(l,{name:"Settings",size:16})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 overflow-x-auto no-scrollbar pb-2 pl-1 pr-4",children:[s.tagsFilterOnInputBar!==!1&&e.jsx(C,{label:"Tags",isActive:N("tags"),count:r.tags.length,onClear:()=>y("tags"),children:e.jsxs("div",{className:"space-y-0.5",children:[n.length===0&&e.jsx("div",{className:"text-xs text-slate-400 p-2 italic text-center",children:"No tags available"}),n.map(t=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-slate-300 font-mono rounded-lg cursor-pointer transition-colors group",children:[e.jsx("input",{type:"checkbox",checked:r.tags.includes(t),onChange:()=>j("tags",t),className:"rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx(l,{name:"Tag",size:12,className:"text-blue-500 opacity-70 group-hover:opacity-100"}),e.jsx("span",{className:"text-sm text-slate-700 group-hover:text-slate-900",children:t})]},t))]})}),s.categoriesFilterOnInputBar!==!1&&e.jsx(C,{label:"Categories",isActive:N("categories"),count:r.categories.length,onClear:()=>y("categories"),children:e.jsxs("div",{className:"space-y-0.5",children:[u.length===0&&e.jsx("div",{className:"text-xs text-slate-400 p-2 italic text-center",children:"No categories available"}),u.map(t=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-slate-300 font-mono rounded-lg cursor-pointer transition-colors group",children:[e.jsx("input",{type:"checkbox",checked:r.categories.includes(t),onChange:()=>j("categories",t),className:"rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx(l,{name:"Folder",size:12,className:"text-amber-500 opacity-70 group-hover:opacity-100"}),e.jsx("span",{className:"text-sm text-slate-700 group-hover:text-slate-900",children:t})]},t))]})}),s.priorityFilterOnInputBar!==!1&&e.jsx(C,{label:"Priority",isActive:N("priorities"),count:r.priorities.length,onClear:()=>y("priorities"),children:e.jsx("div",{className:"space-y-0.5",children:["low","medium","high"].map(t=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-slate-300 font-mono rounded-lg cursor-pointer capitalize transition-colors group",children:[e.jsx("input",{type:"checkbox",checked:r.priorities.includes(t),onChange:()=>j("priorities",t),className:"rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx(l,{name:"Flag",size:12,className:x("opacity-80",K(t)),fill:"currentColor"}),e.jsx("span",{className:"text-sm text-slate-700 group-hover:text-slate-900",children:t})]},t))})}),s.statusFilterOnInputBar!==!1&&e.jsx(C,{label:"Status",isActive:N("statuses"),count:r.statuses.length,onClear:()=>y("statuses"),children:e.jsx("div",{className:"space-y-0.5",children:["todo","doing","scheduled","done","due","overdue","cancelled","unplanned"].map(t=>e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-slate-300 font-mono rounded-lg cursor-pointer capitalize transition-colors group",children:[e.jsx("input",{type:"checkbox",checked:r.statuses.includes(t),onChange:()=>j("statuses",t),className:"rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),e.jsx(l,{name:R(t),size:13,className:x("opacity-80",E(t))}),e.jsx("span",{className:"text-sm text-slate-700 group-hover:text-slate-900",children:t})]},t))})}),(s.tagsFilterOnInputBar!==!1||s.categoriesFilterOnInputBar!==!1||s.priorityFilterOnInputBar!==!1||s.statusFilterOnInputBar!==!1)&&s.sortOnInputBar!==!1&&e.jsx("div",{className:"w-px h-4 bg-slate-300 mx-1 shrink-0"}),s.sortOnInputBar!==!1&&e.jsx(G,{sort:f,onSortChange:h})]})]})})},C=({label:i,isActive:a,count:n,children:u,onClear:s})=>e.jsxs(D,{children:[e.jsx(M,{asChild:!0,children:e.jsxs(q,{whileHover:{scale:1.02},whileTap:{scale:.98},className:x("flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-full border transition-all shrink-0 outline-none select-none",a?"bg-slate-800 text-white border-slate-800 shadow-md shadow-slate-200":"bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:text-slate-800"),children:[i,a&&e.jsx("span",{className:"flex items-center justify-center bg-white text-slate-900 text-[9px] font-bold h-4 min-w-4 px-0.5 rounded-full",children:n}),e.jsx(l,{name:"ChevronDown",size:12,className:x("transition-transform duration-200",a?"text-slate-300":"opacity-40")})]})}),e.jsx(P,{side:"bottom",align:"start",sideOffset:8,collisionPadding:16,className:"outline-none w-auto p-0",style:{zIndex:99999},children:e.jsxs(I,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},transition:{duration:.15,ease:"easeOut"},className:"w-56 bg-slate-50 border border-slate-200 shadow-lg rounded-lg overflow-hidden p-1",children:[e.jsxs("div",{className:"flex justify-between items-center px-3 py-2 border-b border-slate-200 mb-1",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:i}),a&&e.jsx("button",{onClick:s,className:"text-[10px] font-medium text-rose-500 hover:text-rose-600 px-1.5 py-0.5 rounded hover:bg-rose-50 transition-colors",children:"Clear"})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto p-1 custom-scrollbar",children:u})]})})]}),G=({sort:i,onSortChange:a})=>{const n=[{label:"Due Date",value:"dueAt",icon:"Calendar"},{label:"Created Date",value:"createdAt",icon:"Clock"},{label:"Priority",value:"priority",icon:"Flag"},{label:"Title",value:"title",icon:"Type"}],u=s=>{i.field===s?a({...i,direction:i.direction==="asc"?"desc":"asc"}):a({...i,field:s,direction:"asc"})};return e.jsxs(D,{children:[e.jsx(M,{asChild:!0,children:e.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-slate-100 hover:bg-slate-200 text-slate-600 hover:text-slate-900 text-xs font-bold rounded-full transition-all shrink-0 outline-none ml-auto active:scale-95",children:[e.jsx(l,{name:"ArrowUpDown",size:12}),e.jsx("span",{children:"Sort"})]})}),e.jsx(P,{side:"bottom",align:"end",sideOffset:8,collisionPadding:16,className:"outline-none w-auto p-0",style:{zIndex:99999},children:e.jsxs(I,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},transition:{duration:.15,ease:"easeOut"},className:"w-48 bg-slate-50 border border-slate-200 shadow-lg rounded-lg overflow-hidden p-1",children:[e.jsx("div",{className:"px-3 py-2 text-[10px] font-bold text-slate-400 uppercase border-b border-slate-200 mb-1",children:"Sort By"}),e.jsx("div",{className:"flex flex-col gap-0.5",children:n.map(s=>{const r=i.field===s.value;return e.jsx("button",{onClick:()=>u(s.value),children:e.jsxs("div",{className:x("flex items-center justify-start! text-sm rounded-lg outline-none hover:bg-slate-300 font-mono w-full p-2",r?"text-slate-900":"text-slate-600 hover:text-slate-900"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{name:s.icon,size:14,className:r?"text-blue-500":"opacity-70"}),e.jsx("span",{children:s.label})]}),r&&e.jsx("div",{className:"flex items-center gap-1 text-blue-500",children:e.jsx(l,{name:i.direction==="asc"?"ArrowUp":"ArrowDown",size:18})})]})},s.value)})})]})})]})};Z.__docgenInfo={description:"",methods:[],displayName:"InputBar"};export{Z as I};
